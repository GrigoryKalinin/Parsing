# Система обработки каталога товаров с ИИ

Автоматизированная система для создания и заполнения каталога товаров с использованием ИИ для генерации SEO контента.

## Требования

```bash
pip install -r requirements.txt
```

## Настройка

1. Создайте файл `.env` на основе `.env.example`:
```
API_KEY=ваш-api-ключ-openrouter
MODEL=deepseek/deepseek-chat
```

## Порядок выполнения скриптов

### 1. Подготовка данных
```bash
python excel_to_csv.py
```
**Что делает:** Конвертирует Excel прайс-лист в CSV файл `price_new.csv`

### 2. Создание каталога
```bash
python update_catalog.py
```
**Что делает:** 
- Создает `catalog6_new.csv` из `price_new.csv`
- Автоматически заполняет: SEO H1, Количество (10), Количество на складе (10), Включен (+)

### 3. Добавление описаний в XML
```bash
python add_descriptions_to_xml.py
```
**Что делает:**
- Находит товары без описания в `feed-yml-0.xml`
- Генерирует описания с помощью ИИ для товаров без description
- Обновляет XML файл с новыми описаниями

### 4. Форматирование описаний
```bash
python final_update_catalog_format_description.py
```
**Что делает:**
- Добавляет описания из XML файла `feed-yml-0.xml`
- Форматирует HTML описания с техническими характеристиками
- Создает `catalog6_formatted.csv`

### 5. Генерация SEO контента с ИИ
```bash
python full_catalog_with_ai.py
```
**Что делает:**
- Генерирует SEO Title, META Description, META Keywords, Краткое описание
- Использует DeepSeek API через OpenRouter
- Создает `catalog6_ai_filled.csv`

### 6. Очистка ИИ контента
```bash
python clean_ai_content.py
```
**Что делает:**
- Убирает нежелательные символы: `*`, `"`, `'`, HTML-коды
- Очищает HTML теги
- Создает `catalog6_ai_cleaned.csv`

## Дополнительные скрипты

### Тестирование ИИ
```bash
python test_ai_generator.py
```
Тестирует генерацию контента на одном товаре

## Структура файлов

```
├── .env                                    # API ключи (не в git)
├── .env.example                           # Пример настроек
├── requirements.txt                       # Зависимости
├── PROMA_VISPROM_Прайс_лист_*.xlsx       # Исходный Excel файл
├── feed-yml-0.xml                        # XML с описаниями товаров
├── price_new.csv                         # Конвертированный прайс
├── catalog6_new.csv                      # Базовый каталог
├── catalog6_formatted.csv               # С описаниями из XML
├── catalog6_ai_filled.csv               # С ИИ контентом
├── catalog6_ai_cleaned.csv              # Финальный очищенный каталог
├── add_descriptions_to_xml.py           # Скрипт для добавления описаний в XML
├── copy_seo_fields.py                   # Копирование SEO полей между файлами
└── check_empty_fields.py                # Диагностика пустых полей
```

## Генерируемые поля

- **SEO H1** - копируется из наименования товара
- **SEO Title** - генерируется ИИ (до 60 символов)
- **SEO Meta Description** - генерируется ИИ (150-160 символов)  
- **SEO Meta Keywords** - генерируется ИИ (5-10 ключевых слов)
- **Краткое описание** - генерируется ИИ (до 200 символов)
- **Описание** - генерируется ИИ для пустых полей
- **Количество** - автоматически 10
- **Количество на складе** - автоматически 10
- **Включен** - автоматически "+"

## Примечания

- Все скрипты должны запускаться в указанном порядке
- API ключ DeepSeek можно получить на https://openrouter.ai/
- XML файл должен содержать описания товаров с тегами `<description>`, `<tech>`, `<equipment>`
- Скрипт `add_descriptions_to_xml.py` автоматически добавляет недостающие описания в XML
- Промежуточные файлы сохраняются для отладки и восстановления